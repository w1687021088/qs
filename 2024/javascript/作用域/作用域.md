# JavaScript 作用域（词法环境）


## 什么是作用域

在 javascript 中作用域是一种特性，它的存在决定了在代码中的变量、函数和对象的可访问性。也可以说是对资源的一种可见性。

作用域分为全局作用域、局部作用域和块级作用域。

### 全局作用域

在 JavaScript 词法解释阶段中位于顶层的变量和函数皆为全局可访问。


### 局部作用域

局部作用域（函数作用域）定义在内部的变量和函数外部无法访问。

### 块级作用域

块级作用域，存在当前的可访问性，ES6之前不存在块级作用域。

## 作用域链


在当前作用域访问或修改的变量、函数如果不存在于当前的作用域，则向上寻找，如果未找到则报错；


## 上下文环境

JavaScript 作用域的确定阶段在于 JavaScript 词法环境解释阶段中就已确定。

JavaScript 解释阶段：

1. 词法分析；
2. 语法分析；
3. 作用域规则的我确定；

JavaScript 执行阶段：

1. 创建执行的上下文环境；
2. 执行函数代码；

JavaScript 解释阶段便会确定作用域规则，因此作用域在函数定义时就已经确定了，而不是在函数调用时确定，但是执行上下文是函数执行之前创建的。执行上下文最明显的就是 this 的指向是执行时确定的。而作用域访问的变量是编写代码的结构确定的。


## 作用域和执行上下文

它们之间最大的区别在于作用域是在词法环境中就已经确定，执行上下文则是在运行阶段中被确定，额像函数等方式的上下文环境的确定依据与代码中如何调用改函数，相应的调用不同，可能产生的执行上下文环境不一样，this 的执行也会发生变更。


## 闭包


闭包指的是 JavaScript 中运行时存在的一种环境。闭包环境的形成是在内部函数访问外部环境的变量产生。
