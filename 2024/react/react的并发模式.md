# 并发模式


并发渲染是一种新的渲染机制，旨在提升用户界面的响应速度和交互体验。通过并发渲染，React 可以在不阻塞主线程的情况下，优雅地协调渲染工作。

> 当个任务的执行时间大于浏览器一帧，则将主线程交给其他优先级更高的任务执行；



> React18.2版本下并发模式是默认开启，但还是同步遍历渲染方式


只有在调用 useDeferredValue / startTransition

## 并发过程：

任务调度：

依靠内部的调度机制，确定本次执行的优先级，将渲染的任务划分到时间切片中；

时间切片：

React 在分配时间片时，会确保在每个时间片内完成一部分渲染任务，并在时间片用尽时将控制权交还给浏览器，以便浏览器能够处理用户交互和其他任务。


中断与恢复：

React 可以随时中断正在进行的渲染任务，并在需要时恢复，这使得应用能够快速响应用户的输入；



简单来说就是 React 内部调度确定优先级任务，再将任务分配到每个时间片中执行，（如果有一个比较负责的任务时，将切分为多个小块），期间执行过程中如果有其他优先级较高的任务时，将浏览器的主线程交给优先任务比例较高的先执行。

---

## 任务优先级从高到低的具体例子

### Immediate Priority（立即优先级）：

用户点击按钮后立即需要更新 UI 的任务。
输入框中的即时验证。
### User Blocking Priority（用户阻塞优先级）：

表单提交后需要快速反馈给用户的任务。
导航过程中需要加载新的页面内容。
### Normal Priority（普通优先级）：

异步数据请求完成后的 UI 更新。
非关键动画效果的更新。
### Low Priority（低优先级）：

后台数据同步，例如保存草稿。
非关键的状态更新，例如非关键的 UI 元素更新。
### Idle Priority（空闲优先级）：

预加载非关键数据。
缓存清理和性能日志记录。

